This version of the algorithm uses connection types and directions
It has a new component; generator, and so can create series hybrids as well.  